<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Generador de Tareas</title>
<style>
  body{font-family:Arial,Helvetica,sans-serif;background:#7c839e;margin:0;padding:24px;display:flex;justify-content:center}
  .app{width:100%;max-width:600px}
  h1{font-size:1.2rem;margin-bottom:12px}
  .card{background:#95b3c6;border-radius:12px;padding:16px;box-shadow:0 6px 18px rgba(0,0,0,0.08);margin-bottom:16px}
  input[type="text"]{padding:8px;border-radius:6px;border:1px solid #ccc;font-size:1rem;width:100%}
  .controls{margin-top:10px;display:flex;gap:8px;justify-content:flex-end}
  button{background:#2563eb;color:#f0eaea;border:none;padding:8px 12px;border-radius:6px;cursor:pointer}
  button.ghost{background:#fff;color:#2563eb;border:1px solid #2563eb}
  button.danger{background:#e11d48}
  .task{display:flex;justify-content:space-between;align-items:center;padding:8px;border:1px solid #eee;border-radius:6px;margin-bottom:6px;background:#fafafa}
  .title{font-weight:bold}
  .empty{text-align:center;color:#777;padding:20px}
</style>
</head>
<body>
  <main class="app">
    <h1>WPA  Tareas</h1>

    <section class="card">
      <form id="taskForm" onsubmit="return false">
        <input id="title" type="text" placeholder="Escribe una tarea..." required />
        <div class="controls">
          <button id="addBtn" type="button">Agregar</button>
          <button id="updateBtn" type="button" class="ghost" style="display:none">Actualizar</button>
          <button id="cancelEditBtn" type="button" class="ghost" style="display:none">Cancelar</button>
          <button id="saveLocalBtn" type="button" class="ghost">Guardar local</button>
        </div>
      </form>
    </section>

    <section class="card">
      <h2 style="font-size:1rem;margin-top:0">Tareas</h2>
      <div id="tasksContainer"></div>
    </section>
  </main>

<script>
const STORAGE_KEY = 'tasks_minimal';
let tasks = [];
let editId = null;

const titleEl = document.getElementById('title');
const addBtn = document.getElementById('addBtn');
const updateBtn = document.getElementById('updateBtn');
const cancelEditBtn = document.getElementById('cancelEditBtn');
const saveLocalBtn = document.getElementById('saveLocalBtn');
const tasksContainer = document.getElementById('tasksContainer');

// cargar
try {
  const raw = localStorage.getItem(STORAGE_KEY);
  if (raw) tasks = JSON.parse(raw);
} catch { tasks = []; }

renderTasks();

// agregar
addBtn.onclick = () => {
  const title = titleEl.value.trim();
  if (!title) return alert('Escribe una tarea');
  tasks.unshift({id:crypto.randomUUID(),title});
  clearForm();
  renderTasks();
};

// actualizar
updateBtn.onclick = () => {
  if (!editId) return;
  const idx = tasks.findIndex(t => t.id===editId);
  if (idx === -1) return;
  tasks[idx].title = titleEl.value.trim();
  cancelEdit();
  renderTasks();
};

// cancelar edici√≥n
cancelEditBtn.onclick = cancelEdit;
function cancelEdit(){
  editId=null; clearForm();
  addBtn.style.display='inline-block'; updateBtn.style.display='none'; cancelEditBtn.style.display='none';
}

// guardar en local
saveLocalBtn.onclick = () => {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(tasks));
  alert('Guardado en localStorage.');
};

// renderizar
function renderTasks(){
  tasksContainer.innerHTML='';
  if (!tasks.length){tasksContainer.innerHTML='<div class="empty">No hay tareas.</div>'; return;}
  tasks.forEach(t=>{
    const div=document.createElement('div'); div.className='task';
    div.innerHTML=`
      <div class="title">${escapeHtml(t.title)}</div>
      <div class="actions">
        <button class="ghost" onclick="startEdit('${t.id}')">‚úèÔ∏è</button>
        <button class="danger" onclick="deleteTask('${t.id}')">üóëÔ∏è</button>
      </div>`;
    tasksContainer.appendChild(div);
  });
}

function startEdit(id){
  const t=tasks.find(x=>x.id===id); if(!t) return;
  editId=id;
  titleEl.value=t.title;
  addBtn.style.display='none'; updateBtn.style.display='inline-block'; cancelEditBtn.style.display='inline-block';
}
function deleteTask(id){
  const idx=tasks.findIndex(t=>t.id===id); if(idx===-1) return;
  if(!confirm('¬øEliminar esta tarea?')) return;
  tasks.splice(idx,1); renderTasks();
}
function clearForm(){ titleEl.value=''; }
function escapeHtml(s){ return String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;'); }
</script>
</body>
</html>
